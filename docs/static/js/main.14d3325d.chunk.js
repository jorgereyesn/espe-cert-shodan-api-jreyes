(this["webpackJsonpespe-cert-shodan-api-jreyes"]=this["webpackJsonpespe-cert-shodan-api-jreyes"]||[]).push([[0],{132:function(e,n,t){},257:function(e,n,t){"use strict";t.r(n);var i,c,r,a,o,l,s,d,b,j,u,p,h,x,v,O,g,m=t(0),f=t.n(m),k=t(11),y=t.n(k),w=(t(132),t(15)),C=t(293),P=t(4),I=t(5),S=I.a.div(i||(i=Object(P.a)(["\n  background-color: rgba(189, 203, 217);\n  //background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  padding: 2em;\n  color: white;\n  text-align: center;\n"]))),E=t(18),T=t(290),V=Object(I.a)(T.a)(c||(c=Object(P.a)(["\n  width: 100%;\n"]))),F=t(1),W=function(e){var n=e.info,t={labels:n.map((function(e){return e.vuln.ip_str})),datasets:[{label:"Vulnerabilities",backgroundColor:"black",borderColor:n.map((function(e){return e.data.length>100?"red":e.data.length>50?"yellow":"rgba(116, 238, 63)"})),borderWidth:2,data:n.map((function(e){return e.data.length}))}]};return Object(F.jsx)(V,{children:Object(F.jsx)(E.a,{data:t,options:{indexAxis:"y",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Cantidad de vulnerabilidades por IP",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"white",boxWidth:20}}}}})})},z=Object(I.a)(T.a)(r||(r=Object(P.a)(["\n  width: 100%;\n"]))),A=function(e){return e.reduce((function(e,n){return e.includes(n)||e.push(n),e}),[])},D=function(e){var n=[];return null===e||void 0===e||e.map((function(e){return null===e||void 0===e?void 0:e.map((function(e){return n.push(e)}))})),n},N=function(e,n){for(var t,i=[],c=0;c<e.length;c++){t=0;for(var r=0;r<n.length;r++)e[c]===n[r]&&(t+=1);i.push(t)}return i},_=function(e){for(var n=0,t=0,i=0,c=0,r=0,a=0;a<e.length;a++)0!==e[a].cvss&&""!==e[a].cvss&&"undefined"!==e[a].cvss||n++,e[a].cvss>0&&e[a].cvss<4&&t++,e[a].cvss>3.9&&e[a].cvss<7&&i++,e[a].cvss>6.9&&e[a].cvss<9&&c++,e[a].cvss>8.9&&e[a].cvss<11&&r++;return[n,t,i,c,r]},R=function(e){return e.reduce((function(e,n){return e+n}),0)},q=function(e,n){return(e/n).toFixed(2)},L=function(e){var n=e.info,t={labels:["None","Low","Medium","High","Critical"],datasets:[{label:"CVSS Score",backgroundColor:["rgba(255, 255, 255)","rgba(116, 238, 63)","rgba(234, 231, 46)","rgba(237, 45, 19)","rgba(63, 62, 62)"],borderColor:"black",borderWidth:2,data:e.singleIp?_(n):function(e){for(var n=0,t=0,i=0,c=0,r=0,a=0;a<e.length;a++)n+=e[a][0],t+=e[a][1],i+=e[a][2],c+=e[a][3],r+=e[a][4];return[n,t,i,c,r]}(n.map((function(e){return _(e.data)})))}]};return Object(F.jsx)(z,{children:Object(F.jsx)(E.b,{data:t,options:{indexAxis:"y",scales:{x:{ticks:{color:"black",display:!1},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black",display:!1},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Common Vulnerability Scoring System",position:"top",font:{size:20},padding:20,color:"black"},legend:{display:!0,position:"left",labels:{color:"black",boxWidth:20}}}}})})},B=Object(I.a)(T.a)(a||(a=Object(P.a)(["\n  width: 100%;\n"]))),U=function(e){var n=e.info.map((function(e){return e.data.map((function(e){return e.cve.substr(4,4)}))})),t=A(D(n)).sort(),i=N(t,D(n)),c={labels:t,datasets:[{label:"Vulnerabilities",backgroundColor:i.map((function(e){return e>100?"red":e>50?"yellow":"rgba(116, 238, 63)"})),borderColor:"black",borderWidth:2,data:i}]};return Object(F.jsx)(B,{children:Object(F.jsx)(E.c,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"A\xf1os de referencia en CVE-ID",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}}})})},H=Object(I.a)(T.a)(o||(o=Object(P.a)(["\n  width: 100%;\n"]))),G=function(e){var n,t=e.info;n=null===t||void 0===t?void 0:t.map((function(e){var n,t;return null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.ports)||void 0===t?void 0:t.map((function(e){return e}))}));var i=A(D(n)),c={labels:i,datasets:[{label:"IPs",backgroundColor:"black",borderColor:"rgba(75,192,192,1)",borderWidth:2,data:N(i,D(n))}]};return Object(F.jsx)(H,{children:Object(F.jsx)(E.a,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Puertos Abiertos",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}}})})},M=Object(I.a)(T.a)(l||(l=Object(P.a)(["\n  width: 100%;\n"]))),Q=function(e){var n=e.info,t=null===n||void 0===n?void 0:n.map((function(e){var n,t;return null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.tags)||void 0===t?void 0:t.map((function(e){return e}))})),i=A(D(t)),c={labels:i,datasets:[{label:"IPs",backgroundColor:"black",borderColor:"rgba(75,192,192,1)",borderWidth:2,data:N(i,D(t))}]};return Object(F.jsx)(M,{children:Object(F.jsx)(E.a,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Query Tags",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}}})})},J=function(e){var n=e.info;return Object(F.jsx)(S,{children:Object(F.jsxs)(C.a,{container:!0,spacing:3,justifyContent:"center",children:[Object(F.jsx)(C.a,{item:!0,md:6,children:Object(F.jsx)(W,{info:n})}),Object(F.jsx)(C.a,{item:!0,md:6,children:Object(F.jsx)(G,{info:n})}),Object(F.jsx)(C.a,{item:!0,md:6,children:Object(F.jsx)(U,{info:n})}),Object(F.jsx)(C.a,{item:!0,md:6,children:Object(F.jsx)(Q,{info:n})}),Object(F.jsx)(C.a,{item:!0,md:6,children:Object(F.jsx)(L,{info:n,singleIp:!1})})]})})},Y=I.a.div(s||(s=Object(P.a)(["\n  background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  //height: 50em;\n  color: white;\n  text-align: center;\n"]))),K=t(306),X=t(294),Z=t(307),$=Object(I.a)(K.a)(d||(d=Object(P.a)(["\n  //background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  //color: white;\n"]))),ee=Object(I.a)(X.a)(b||(b=Object(P.a)(["\n  background-color: black;\n"]))),ne=Object(I.a)(Z.a)(j||(j=Object(P.a)([""]))),te=Object(I.a)(T.a)(u||(u=Object(P.a)(["\n  color: white;\n  border: 2px solid white;\n  text-align: center;\n  padding: 0.5em;\n"]))),ie=Object(I.a)(C.a)(p||(p=Object(P.a)([""]))),ce=Object(I.a)(C.a)(h||(h=Object(P.a)(["\n  border: 1px solid black;\n"]))),re=Object(I.a)(C.a)(x||(x=Object(P.a)(["\n  border: 1px solid black;\n"]))),ae=Object(I.a)(C.a)(v||(v=Object(P.a)(["\n  background-color: ",";\n  color: ",";\n  border: 1px solid black;\n"])),(function(e){return e.color}),(function(e){return e.textcolor})),oe=Object(I.a)(C.a)(O||(O=Object(P.a)(["\n  border: 1px solid black;\n"]))),le=I.a.a(g||(g=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n  text-decoration: none;\n\n  &:hover {\n    background-color: rgba(116, 238, 63, 0.5);\n    font-weight: 500;\n  }\n"]))),se=t(295),de=t(305),be=t(297),je=t(260),ue=t(296),pe=Object(se.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:"#E3DFDF",border:"3px solid #66FA00",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),maxHeight:"70%",overflow:"scroll"}}}));function he(e){var n=e.buttonName,t=e.references,i=pe(),c=f.a.useState(!1),r=Object(w.a)(c,2),a=r[0],o=r[1];return Object(F.jsxs)("div",{children:[Object(F.jsx)(ue.a,{color:"secondary",onClick:function(){o(!0)},variant:"outlined",children:n}),Object(F.jsx)(de.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:a,onClose:function(){o(!1)},closeAfterTransition:!0,BackdropComponent:be.a,BackdropProps:{timeout:500},children:Object(F.jsx)(je.a,{in:a,children:Object(F.jsx)("div",{className:i.paper,children:t.map((function(e,n){return Object(F.jsx)("p",{children:Object(F.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",children:[e," "]},n+e)})}))})})})]})}var xe,ve,Oe,ge,me,fe,ke=function(e){var n=e.cve,t=e.references,i=e.cvss,c=e.summary,r="",a="black";return i>0&&i<4&&(r="green",a="white"),i>3.9&&i<7&&(r="yellow"),i>6.9&&i<9&&(r="red",a="white"),i>8.9&&i<11&&(r="#34495E",a="white"),Object(F.jsx)(te,{children:Object(F.jsxs)(ie,{container:!0,justifyContent:"center",alignItems:"center",children:[Object(F.jsx)(ce,{item:!0,xs:3,children:Object(F.jsx)(le,{href:"https://nvd.nist.gov/vuln/detail/"+n,target:"_blank",children:n})}),Object(F.jsx)(re,{item:!0,xs:3,children:Object(F.jsx)(he,{buttonName:"Solution Links",references:t})}),Object(F.jsx)(ae,{item:!0,xs:3,color:r,textcolor:a,children:i}),Object(F.jsx)(oe,{item:!0,xs:12,children:c})]})})},ye=Object(I.a)(T.a)(xe||(xe=Object(P.a)(["\n  background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  color: white;\n  border: 2px solid white;\n  padding: 0.5em;\n"]))),we=Object(I.a)(C.a)(ve||(ve=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n"]))),Ce=Object(I.a)(C.a)(Oe||(Oe=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n"]))),Pe=I.a.h2(ge||(ge=Object(P.a)([""]))),Ie=I.a.strong(me||(me=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n"]))),Se=I.a.a(fe||(fe=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n  text-decoration: none;\n\n  &:hover {\n    background-color: rgba(116, 238, 63, 0.5);\n    font-weight: 500;\n  }\n"]))),Ee=Object(se.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:"rgba(189, 203, 217)",border:"2px solid red",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function Te(e){var n=e.buttonName,t=e.info,i=Ee(),c=f.a.useState(!1),r=Object(w.a)(c,2),a=r[0],o=r[1];return Object(F.jsxs)("div",{children:[Object(F.jsx)(ue.a,{color:"inherit",onClick:function(){o(!0)},variant:"outlined",display:"none",children:n}),Object(F.jsx)(de.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:a,onClose:function(){o(!1)},closeAfterTransition:!0,BackdropComponent:be.a,BackdropProps:{timeout:500},children:Object(F.jsx)(je.a,{in:a,children:Object(F.jsx)("div",{className:i.paper,children:Object(F.jsx)(L,{info:t,singleIp:!0})})})})]})}var Ve,Fe,We,ze,Ae,De,Ne,_e,Re,qe,Le,Be=function(e){var n=e.ip,t=e.numVulns,i=e.org,c=e.isp,r=e.data,a=e.lastUpdate,o=e.country,l=e.city,s=e.asn,d=e.tags,b=e.ports,j=e.hostnames,u=e.domains,p="";return p=t>0?"Se han detectado ".concat(t," vulnerabilidades"):"No se han detectado vulnerabilidades",Object(F.jsx)(ye,{children:Object(F.jsxs)(we,{container:!0,justifyContent:"center",alignItems:"center",spacing:3,children:[Object(F.jsx)(Ce,{item:!0,xs:3,children:Object(F.jsxs)(Pe,{children:["IP: ",n]})}),Object(F.jsx)(Ce,{item:!0,xs:3,children:p}),Object(F.jsxs)(Ce,{item:!0,xs:3,children:["ORG: ",i]}),Object(F.jsxs)(Ce,{item:!0,xs:3,children:["ISP: ",c]}),Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Last_Update: ",a]}),Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Location: ",o," - ",l]}),Object(F.jsxs)(Ce,{item:!0,xs:3,children:["ASN: ",s]}),d&&Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Tags:"," ",d.map((function(e,n){return Object(F.jsx)(Ie,{children:e},e+n)}))]}),b&&Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Ports:"," ",b.map((function(e,t){return Object(F.jsx)(Se,{href:"https://"+n+":"+e,target:"_blank",children:e},e+t)}))]}),j&&Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Hostnames:"," ",j.map((function(e,n){return Object(F.jsx)(Se,{href:"https://"+e,target:"_blank",children:e},e+n)}))]}),u&&Object(F.jsxs)(Ce,{item:!0,xs:3,children:["Domain: ",u.map((function(e){return e}))]}),t>0&&Object(F.jsx)(Ce,{item:!0,xs:3,children:Object(F.jsx)(Te,{info:r,buttonName:"RESUMEN CVSS +"})})]})})},Ue=function(e){var n=e.ip,t=e.data,i=e.org,c=e.isp,r=e.lastUpdate,a=e.country,o=e.city,l=e.asn,s=e.tags,d=e.ports,b=e.hostnames,j=e.domains;return Object(F.jsxs)($,{children:[Object(F.jsx)(ne,{children:Object(F.jsx)(Be,{ip:n,numVulns:t.length,org:i,isp:c,data:t,lastUpdate:"".concat(null===r||void 0===r?void 0:r.substr(0,10)," ").concat(null===r||void 0===r?void 0:r.substr(11,8)),country:a,city:o,asn:l,tags:s,ports:d,hostnames:b,domains:j})}),t.map((function(e,t){return Object(F.jsx)(ee,{children:Object(F.jsx)(ke,{cve:e.cve,cvss:e.cvss,summary:e.summary,references:e.references})},"SHdata-".concat(n)+t)}))]})},He=function(e){var n=e.info;return Object(F.jsx)(Y,{children:n.map((function(e,n){return"undefined"!=typeof e.vuln.vulns?Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(Ue,{ip:e.vuln.ip_str,data:e.data,org:e.vuln.org,isp:e.vuln.isp,lastUpdate:e.vuln.last_update,country:e.vuln.country_name,city:e.vuln.city,asn:e.vuln.asn,tags:e.vuln.tags,ports:e.vuln.ports,hostnames:e.vuln.hostnames,domains:e.vuln.domains},"sh"-n-e.vuln.ip_str)}):Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(Ue,{ip:e.vuln.ip_str,data:[],org:e.vuln.org,isp:e.vuln.isp,lastUpdate:e.vuln.last_update,country:e.vuln.country_name,city:e.vuln.city,asn:e.vuln.asn,tags:e.vuln.tags,ports:e.vuln.ports,hostnames:e.vuln.hostnames,domains:e.vuln.domains},"shSV"-n-e.vuln.ip_str)})}))})},Ge=t(121),Me=t.n(Ge),Qe=I.a.div(Ve||(Ve=Object(P.a)(["\n  padding-top: 100px;\n  background-color: rgba(189, 203, 217);\n"]))),Je=I.a.h2(Fe||(Fe=Object(P.a)(["\n  margin: 0;\n  padding: 0.5em;\n  background-color: black;\n  color: white;\n  text-align: center;\n"]))),Ye=I.a.p(We||(We=Object(P.a)(["\n  margin: 0;\n  padding: 0.5em;\n  background-color: black;\n  color: white;\n  text-align: right;\n  font-size: 1.8em;\n  font-weight: 500;\n"]))),Ke=I.a.hr(ze||(ze=Object(P.a)(["\n  border: 4px solid green;\n  margin: 0;\n"]))),Xe=I.a.p(Ae||(Ae=Object(P.a)(["\n  color: black;\n  background-color: rgba(116, 238, 63, 0.5);\n  border-radius: 10px;\n  margin: 0;\n  padding: 0.5em;\n  text-align: left;\n  font-size: 1.2em;\n"]))),Ze=I.a.h3(De||(De=Object(P.a)(["\n  color: ",";\n  padding: 1em;\n"])),(function(e){var n;return null!==(n=e.color)&&void 0!==n?n:"white"})),$e=I.a.div(Ne||(Ne=Object(P.a)(["\n  background-color: ",";\n  height: 100%;\n"])),(function(e){return e.color})),en=I.a.div(_e||(_e=Object(P.a)(["\n  background-color: black;\n  height: 100%;\n"]))),nn=Object(I.a)(C.a)(Re||(Re=Object(P.a)(["\n  padding: 2em;\n"]))),tn=I.a.div(qe||(qe=Object(P.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding-top: 15em;\n  padding-bottom: 15em;\n"]))),cn=I.a.h2(Le||(Le=Object(P.a)(["\n  color: #7ed321;\n  font-size: 30px;\n"]))),rn=t(299),an=t(303),on=t(302),ln=t(298),sn=t(300),dn=t(301),bn=t(259);var jn,un,pn,hn,xn,vn,On,gn,mn,fn,kn,yn=function(e){var n,t,i,c,r,a,o,l=e.info,s=l.map((function(e){return e.data.length})),d=R(s),b=D(null===(n=l)||void 0===n?void 0:n.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return 1*e.cvss}))}))),j=(q(R(b),d),function(e,n){var t,i=(new Date).getFullYear();e=null===(t=e)||void 0===t?void 0:t.map((function(e){return 365*(i-e)}));var c,r=1*(R(e)/n).toFixed(2);return r>=280?c=1:r>=140&&r<280?c=.5:r<140&&(c=.1),c}(D(l.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n;return 1*(null===e||void 0===e||null===(n=e.cve)||void 0===n?void 0:n.substr(4,4))}))}))),d));null===(t=l)||void 0===t||t.map((function(e){var n;return e.vuln.poe=(1*(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length)/d).toFixed(2)}));var u=l.map((function(e){var n;return null===e||void 0===e||null===(n=e.vuln)||void 0===n?void 0:n.ports})),p=A(D(u));null===(i=l)||void 0===i||i.map((function(e){var n,t,i,c;return e.vuln.popI=1*(null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.ports)||void 0===t?void 0:t.length)>=10?1:(1*(null===e||void 0===e||null===(i=e.vuln)||void 0===i||null===(c=i.ports)||void 0===c?void 0:c.length)/p.length).toFixed(2)})),null===(c=l)||void 0===c||c.map((function(e){var n,t;return e.vuln.pqt=1*(null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.tags)||void 0===t?void 0:t.length)>0?1:0})),null===(r=l)||void 0===r||r.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n,t;return e.tr=(null===e||void 0===e||null===(n=e.references)||void 0===n?void 0:n.length)>10?1:((null===e||void 0===e||null===(t=e.references)||void 0===t?void 0:t.length)/10).toFixed(2)}))})),null===(a=l)||void 0===a||a.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return e.ep=1*(null===e||void 0===e?void 0:e.cvss)>=7?1:1*(null===e||void 0===e?void 0:e.cvss)>=4&&1*(null===e||void 0===e?void 0:e.cvss)<7?.5:.1}))})),l=function(e,n){console.log(e);for(var t=0;t<(null===e||void 0===e?void 0:e.length);t++){e[t].vuln.poe=1*e[t].vuln.poe,e[t].vuln.popI=1*e[t].vuln.popI,e[t].vuln.pqt=1*e[t].vuln.pqt;for(var i=0;i<(null===(c=e[t])||void 0===c||null===(r=c.data)||void 0===r?void 0:r.length);i++){var c,r;e[t].data[i].poe=1*e[t].vuln.poe,e[t].data[i].popI=1*e[t].vuln.popI,e[t].data[i].pqt=1*e[t].vuln.pqt,e[t].data[i].cvss=1*e[t].data[i].cvss,e[t].data[i].tr=1*e[t].data[i].tr,e[t].data[i].po=1*((e[t].data[i].tr+e[t].data[i].ep)/2*((e[t].vuln.poe+e[t].vuln.popI+e[t].vuln.pqt)/3)*n).toFixed(2),e[t].data[i].impact=e[t].data[i].cvss/10,e[t].data[i].rf=1*(e[t].data[i].po*e[t].data[i].impact).toFixed(2),e[t].data[i].ip=e[t].vuln.ip_str}}return e}(l,j);var h,x,v,O=(h=D(null===(o=l)||void 0===o?void 0:o.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return e}))}))),x="rf",v="desc",h.sort((function(e,n){var t=e[x],i=n[x];return"asc"===v?t<i?-1:t>i?1:0:"desc"===v?t>i?-1:t<i?1:0:void 0})));console.log(l);var g=[];return null===O||void 0===O||O.map((function(e,n){var t=e.ip,i=e.cve,c=e.cvss,r=e.tr,a=e.ep,o=e.poe,l=e.popI,s=e.pqt,d=e.rf;return g.push(function(e,n,t,i,c,r,a,o,l,s){return{id:e,ip:n,cve:t,cvss:i,tr:c,ep:r,poe:a,popI:o,pqt:l,risk:s}}("ESP-vuln-"+(n+1)+"-"+i,t,i,c,r,a,o,l,s,d))})),Object(F.jsx)(bn.a,{sx:{width:"100%",overflow:"hidden"},children:Object(F.jsx)(ln.a,{sx:{maxHeight:"440px"},children:Object(F.jsxs)(rn.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(F.jsx)(sn.a,{children:Object(F.jsxs)(dn.a,{children:[Object(F.jsx)(on.a,{align:"center",style:{minWidth:100},children:"ID"},"id"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"IP"},"ip"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"CVE"},"cve"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"CVSS"},"cvss"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"TR"},"tr"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"EP"},"ep"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"POE"},"poe"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"POP"},"popI"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"PQT"},"pqt"),Object(F.jsx)(on.a,{align:"center",style:{minWidth:90},children:"RISK FACTOR"},"rf")]})}),Object(F.jsx)(an.a,{children:g.map((function(e,n){var t=e.ip,i=e.cve,c=e.cvss,r=e.tr,a=e.ep,o=e.poe,l=e.popI,s=e.pqt,d=e.risk,b=(e.name,e.id);return Object(F.jsxs)(dn.a,{children:[Object(F.jsx)(on.a,{component:"th",scope:"row",align:"center",children:b}),Object(F.jsx)(on.a,{align:"center",children:t}),Object(F.jsx)(on.a,{align:"center",children:i}),Object(F.jsx)(on.a,{align:"center",children:c}),Object(F.jsx)(on.a,{align:"center",children:r}),Object(F.jsx)(on.a,{align:"center",children:a}),Object(F.jsx)(on.a,{align:"center",children:o}),Object(F.jsx)(on.a,{align:"center",children:l}),Object(F.jsx)(on.a,{align:"center",children:s}),Object(F.jsx)(on.a,{align:"center",children:d})]},n+i)}))})]})})})},wn=function(){var e,n=Object(m.useState)(["192.188.58.61","192.188.58.50","192.188.58.45","192.188.58.59","192.188.58.63","192.188.58.78","192.188.58.180","192.188.58.75"]),t=Object(w.a)(n,1)[0],i=function(e){for(var n=[],t=0;t<(null===e||void 0===e?void 0:e.length);t++){var i,c;(null===(i=e[t])||void 0===i||null===(c=i.data)||void 0===c?void 0:c.length)>1&&n.push(e[t])}return n}(t.map((function(e){return function(e){var n=Object(m.useState)([]),t=Object(w.a)(n,2),i=t[0],c=t[1],r=Object(m.useState)([]),a=Object(w.a)(r,2),o=a[0],l=a[1];return Object(m.useEffect)((function(){fetch("https://api.shodan.io/shodan/host/"+e+"?key=FL5f6aSOu464esmyqf7c0kDDi0UycPNN").then((function(e){return e.json()})).then((function(e){if("undefined"!=typeof e.vulns){c(e);var n=function(e,n){for(var t=[],i=[],c=0,r=0;r<e.length;r++)"undefined"!=typeof e[r].vulns&&t.push(e[r].vulns);for(var a=0;a<n.length;a++){c=0;for(var o=0;o<t.length;o++)"undefined"!=typeof t[o][n[a]]&&n[a].index===t[o][n[a]].index&&c<1&&(t[o][n[a]].cve=n[a],i.push(t[o][n[a]]),c++)}return i}(e.data,e.vulns);l(n)}}),(function(e){console.log(e)}))}),[e]),{vuln:i,data:o}}(e)}))),c=null===i||void 0===i?void 0:i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length})),r=R(c),a=D(null===i||void 0===i?void 0:i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return 1*e.cvss}))}))),o=q(R(a),r),l=D(i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n;return 1*(null===e||void 0===e||null===(n=e.cve)||void 0===n?void 0:n.substr(4,4))}))}))),s=(new Date).getFullYear();l=null===(e=l)||void 0===e?void 0:e.map((function(e){return 365*(s-e)}));var d=1*(R(l)/r).toFixed(2),b=o>0&&o<=3.9?"rgba(116, 238, 63)":o>3.9&&o<=6.9?"rgba(234, 231, 46)":o>6.9&&o<=8.9?"rgba(237, 45, 19)":"rgba(63, 62, 62)",j=Object(m.useState)(!1),u=Object(w.a)(j,2),p=u[0],h=u[1];return Object(m.useEffect)((function(){h(!0),setTimeout((function(){h(!1)}),8e3)}),[]),Object(F.jsx)(F.Fragment,{children:p?Object(F.jsxs)(tn,{children:[Object(F.jsx)(Me.a,{size:100,color:"#7ED321",loading:p}),Object(F.jsx)(cn,{children:"CARGANDO....."})]}):Object(F.jsxs)(Qe,{id:"top",children:[Object(F.jsx)(Ke,{}),Object(F.jsxs)("section",{id:"gi",children:[Object(F.jsx)(Je,{children:"Informacion General de la Organizacion"}),Object(F.jsxs)(nn,{container:!0,justifyContent:"center",spacing:3,children:[Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(en,{children:[Object(F.jsx)(Ze,{children:"Organizacion"}),Object(F.jsx)(Ye,{children:"Escuela Politecnica del Ejercito"}),Object(F.jsx)(Ke,{})]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(en,{children:[Object(F.jsx)(Ze,{children:"Total de vulnerabilidades identificadas"}),Object(F.jsx)(Ye,{children:r}),Object(F.jsx)(Ke,{})]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(en,{children:[Object(F.jsx)(Ze,{children:"Total de IP escaneadas"}),Object(F.jsx)(Ye,{children:null===t||void 0===t?void 0:t.length}),Object(F.jsx)(Ke,{})]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(en,{children:[Object(F.jsx)(Ze,{children:"Total de IP con Vulnerabilidades"}),Object(F.jsx)(Ye,{children:null===i||void 0===i?void 0:i.length}),Object(F.jsx)(Ke,{})]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)($e,{color:b,children:[Object(F.jsx)(Ze,{color:"rgba(63, 62, 62)"===b?"white":"black",children:"Riesgo Promedio de la Organizacion (AOR)"}),Object(F.jsx)(Ye,{children:o}),Object(F.jsx)(Ke,{})]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(en,{children:[Object(F.jsx)(Ze,{children:"Tiempo Promedio de Vulnerabilidades (AVT)"}),Object(F.jsxs)(Ye,{children:[d," dias"]}),Object(F.jsx)(Ke,{})]})})]})]}),Object(F.jsxs)("section",{id:"vi",children:[Object(F.jsx)(Ke,{}),Object(F.jsx)(Je,{children:"Informacion General de Vulnerabilidades"}),Object(F.jsx)(J,{info:i})]}),Object(F.jsxs)("section",{id:"db",children:[Object(F.jsx)(Ke,{}),Object(F.jsx)(Je,{children:"IP Banner y Vulnerabilidades Detalladas"}),Object(F.jsx)(He,{info:i})]}),Object(F.jsxs)("section",{id:"pt",children:[Object(F.jsx)(Ke,{}),Object(F.jsx)(Je,{children:"Priorizacion de Vulnerabilidades"}),Object(F.jsx)(Ke,{}),Object(F.jsx)(Je,{children:"Descripcion Variables de Entorno"}),Object(F.jsxs)(nn,{container:!0,justifyContent:"center",spacing:3,children:[Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"CVE: "})," Common Vulnerabilities and Exposures"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"CVSS: "})," Common Vulnerability Scoring System"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"TR: "})," Total References"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"EP: "})," Exploitation Probability"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"POE: "})," Probability of Occurrence of an Event in the IP"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"POP: "})," Probability of Open Ports"]})}),Object(F.jsx)(C.a,{item:!0,md:4,children:Object(F.jsxs)(Xe,{children:[Object(F.jsx)("strong",{children:"PQT: "})," Probability for Query Tags"]})})]}),Object(F.jsx)(Ke,{}),Object(F.jsx)(Je,{children:"Tabla de Priorizacion"}),Object(F.jsx)(Ke,{}),Object(F.jsx)(yn,{info:i})]})]})})},Cn=t.p+"static/media/espe.42418c2e.png",Pn=t(304),In=t(88),Sn=Object(I.a)(Pn.a)(jn||(jn=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n  background-color: white !important;\n"]))),En=Object(I.a)(T.a)(un||(un=Object(P.a)(["\n  padding: 0.5em;\n"]))),Tn=I.a.nav(pn||(pn=Object(P.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n"]))),Vn=Object(I.a)(In.Link)(hn||(hn=Object(P.a)(["\n  color: black !important;\n  text-transform: uppercase;\n  font-size: 1em;\n  text-align: center;\n\n  &:hover {\n    border-bottom: 3px solid green;\n  }\n"]))),Fn=Object(I.a)(In.Link)(xn||(xn=Object(P.a)([""]))),Wn=I.a.img(vn||(vn=Object(P.a)(["\n  width: 200px;\n  height: 55px;\n"]))),zn=function(){return Object(F.jsx)(Sn,{children:Object(F.jsx)(En,{children:Object(F.jsxs)(Tn,{children:[Object(F.jsx)(Fn,{to:"top",spy:!0,smooth:!0,children:Object(F.jsx)(Wn,{src:Cn,alt:"logo"})}),Object(F.jsx)(Vn,{to:"gi",spy:!0,smooth:!0,children:"Informacion General"}),Object(F.jsx)(Vn,{to:"vi",spy:!0,smooth:!0,children:"Informacion de Vulnerabilidades"}),Object(F.jsx)(Vn,{to:"db",spy:!0,smooth:!0,children:"Banner Detallados"}),Object(F.jsx)(Vn,{to:"pt",spy:!0,smooth:!0,children:"Tabla de Priorizacion"})]})})})},An=I.a.footer(On||(On=Object(P.a)(["\n  border-top: 5px solid green;\n"]))),Dn=Object(I.a)(T.a)(gn||(gn=Object(P.a)([""]))),Nn=I.a.div(mn||(mn=Object(P.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]))),_n=I.a.img(fn||(fn=Object(P.a)(["\n  width: 200px;\n  height: 55px;\n"]))),Rn=I.a.p(kn||(kn=Object(P.a)(["\n  max-width: 300px;\n"]))),qn=function(){return Object(F.jsx)(An,{children:Object(F.jsx)(Dn,{children:Object(F.jsxs)(Nn,{children:[Object(F.jsx)(_n,{src:Cn}),Object(F.jsxs)(Rn,{children:[Object(F.jsx)("strong",{children:"PROJECT NAME."})," ",Object(F.jsx)("br",{}),"Design and Implementation of the IT infrastructure and service management system for the ESPE Academic CERT"]}),Object(F.jsxs)(Rn,{children:[Object(F.jsx)("strong",{children:"\xa9 2021 PIC-2020-ESPE-CERT."})," ",Object(F.jsx)("br",{}),"Todos los derechos reservados."]})]})})})};var Ln=function(){return Object(F.jsxs)("div",{children:[Object(F.jsx)(zn,{}),Object(F.jsx)(wn,{}),Object(F.jsx)(qn,{})]})},Bn=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,308)).then((function(n){var t=n.getCLS,i=n.getFID,c=n.getFCP,r=n.getLCP,a=n.getTTFB;t(e),i(e),c(e),r(e),a(e)}))};y.a.render(Object(F.jsx)(f.a.StrictMode,{children:Object(F.jsx)(Ln,{})}),document.getElementById("root")),Bn()}},[[257,1,2]]]);
//# sourceMappingURL=main.14d3325d.chunk.js.map