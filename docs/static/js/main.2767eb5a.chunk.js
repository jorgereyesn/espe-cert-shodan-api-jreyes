(this["webpackJsonpespe-cert-shodan-api-jreyes"]=this["webpackJsonpespe-cert-shodan-api-jreyes"]||[]).push([[0],{135:function(e,n,t){},263:function(e,n,t){"use strict";t.r(n);var i,c,a,r,o,l,s,d,b,j,u,p,h,x,v,O,g,m=t(0),f=t.n(m),k=t(11),y=t.n(k),w=(t(135),t(15)),C=t(299),P=t(3),I=t(4),S=I.a.div(i||(i=Object(P.a)(["\n  background-color: rgba(189, 203, 217);\n  //background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  padding: 2em;\n  color: white;\n  text-align: center;\n"]))),E=t(18),T=t(296),V=Object(I.a)(T.a)(c||(c=Object(P.a)(["\n  width: 100%;\n"]))),z=t(1),W=function(e){var n=e.info,t={labels:n.map((function(e){return e.vuln.ip_str})),datasets:[{label:"Vulnerabilities",backgroundColor:"black",borderColor:n.map((function(e){return e.data.length>100?"red":e.data.length>50?"yellow":"rgba(116, 238, 63)"})),borderWidth:2,data:n.map((function(e){return e.data.length}))}]};return Object(z.jsx)(V,{children:Object(z.jsx)(E.a,{data:t,options:{indexAxis:"y",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Cantidad de vulnerabilidades por IP",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"white",boxWidth:20}}}},type:""})})},F=Object(I.a)(T.a)(a||(a=Object(P.a)(["\n  width: 100%;\n"]))),A=function(e){return e.reduce((function(e,n){return e.includes(n)||e.push(n),e}),[])},N=function(e){var n=[];return null===e||void 0===e||e.map((function(e){return null===e||void 0===e?void 0:e.map((function(e){return n.push(e)}))})),n},D=function(e,n){for(var t,i=[],c=0;c<e.length;c++){t=0;for(var a=0;a<n.length;a++)e[c]===n[a]&&(t+=1);i.push(t)}return i},_=function(e){for(var n=0,t=0,i=0,c=0,a=0,r=0;r<e.length;r++)0!==e[r].cvss&&""!==e[r].cvss&&"undefined"!==e[r].cvss||n++,e[r].cvss>0&&e[r].cvss<4&&t++,e[r].cvss>3.9&&e[r].cvss<7&&i++,e[r].cvss>6.9&&e[r].cvss<9&&c++,e[r].cvss>8.9&&e[r].cvss<11&&a++;return[n,t,i,c,a]},R=function(e){return e.reduce((function(e,n){return e+n}),0)},q=function(e,n){return(e/n).toFixed(2)},L=function(e){var n=e.info,t={labels:["None","Low","Medium","High","Critical"],datasets:[{label:"CVSS Score",backgroundColor:["rgba(255, 255, 255)","rgba(116, 238, 63)","rgba(234, 231, 46)","rgba(237, 45, 19)","rgba(63, 62, 62)"],borderColor:"black",borderWidth:2,data:e.singleIp?_(n):function(e){for(var n=0,t=0,i=0,c=0,a=0,r=0;r<e.length;r++)n+=e[r][0],t+=e[r][1],i+=e[r][2],c+=e[r][3],a+=e[r][4];return[n,t,i,c,a]}(n.map((function(e){return _(e.data)})))}]};return Object(z.jsx)(F,{children:Object(z.jsx)(E.b,{data:t,options:{indexAxis:"y",scales:{x:{ticks:{color:"black",display:!1},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black",display:!1},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Common Vulnerability Scoring System",position:"top",font:{size:20},padding:20,color:"black"},legend:{display:!0,position:"left",labels:{color:"black",boxWidth:20}}}},type:""})})},U=Object(I.a)(T.a)(r||(r=Object(P.a)(["\n  width: 100%;\n"]))),B=function(e){var n=e.info.map((function(e){return e.data.map((function(e){return e.cve.substr(4,4)}))})),t=A(N(n)).sort(),i=D(t,N(n)),c={labels:t,datasets:[{label:"Vulnerabilities",backgroundColor:i.map((function(e){return e>100?"red":e>50?"yellow":"rgba(116, 238, 63)"})),borderColor:"black",borderWidth:2,data:i}]};return Object(z.jsx)(U,{children:Object(z.jsx)(E.c,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"A\xf1os de referencia en CVE-ID",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}},type:""})})},H=Object(I.a)(T.a)(o||(o=Object(P.a)(["\n  width: 100%;\n"]))),G=function(e){var n,t=e.info;n=null===t||void 0===t?void 0:t.map((function(e){var n,t;return null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.ports)||void 0===t?void 0:t.map((function(e){return e}))}));var i=A(N(n)),c={labels:i,datasets:[{label:"IPs",backgroundColor:"black",borderColor:"rgba(75,192,192,1)",borderWidth:2,data:D(i,N(n))}]};return Object(z.jsx)(H,{children:Object(z.jsx)(E.a,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Puertos Abiertos",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}},type:""})})},Q=Object(I.a)(T.a)(l||(l=Object(P.a)(["\n  width: 100%;\n"]))),J=function(e){var n=e.info,t=null===n||void 0===n?void 0:n.map((function(e){var n,t;return null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.tags)||void 0===t?void 0:t.map((function(e){return e}))})),i=A(N(t)),c={labels:i,datasets:[{label:"IPs",backgroundColor:"black",borderColor:"rgba(75,192,192,1)",borderWidth:2,data:D(i,N(t))}]};return Object(z.jsx)(Q,{children:Object(z.jsx)(E.a,{data:c,options:{indexAxis:"x",scales:{x:{ticks:{color:"black"},grid:{offset:!1,color:"black"}},y:{ticks:{color:"black"},grid:{offset:!1,color:"black"}}},plugins:{title:{display:!0,text:"Query Tags",font:{size:20},padding:20,color:"black"},legend:{display:!1,position:"top",labels:{color:"black",boxWidth:20}}}},type:""})})},M=function(e){var n=e.info;return Object(z.jsx)(S,{children:Object(z.jsxs)(C.a,{container:!0,spacing:3,justifyContent:"center",children:[Object(z.jsx)(C.a,{item:!0,md:6,children:Object(z.jsx)(W,{info:n})}),Object(z.jsx)(C.a,{item:!0,md:6,children:Object(z.jsx)(G,{info:n})}),Object(z.jsx)(C.a,{item:!0,md:6,children:Object(z.jsx)(B,{info:n})}),Object(z.jsx)(C.a,{item:!0,md:6,children:Object(z.jsx)(J,{info:n})}),Object(z.jsx)(C.a,{item:!0,md:6,children:Object(z.jsx)(L,{info:n,singleIp:!1})})]})})},Y=I.a.div(s||(s=Object(P.a)(["\n  background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  //height: 50em;\n  color: white;\n  text-align: center;\n"]))),K=t(312),X=t(300),Z=t(313),$=Object(I.a)(K.a)(d||(d=Object(P.a)(["\n  //background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  //color: white;\n"]))),ee=Object(I.a)(X.a)(b||(b=Object(P.a)(["\n  background-color: black;\n"]))),ne=Object(I.a)(Z.a)(j||(j=Object(P.a)([""]))),te=Object(I.a)(T.a)(u||(u=Object(P.a)(["\n  color: white;\n  border: 2px solid white;\n  text-align: center;\n  padding: 0.5em;\n"]))),ie=Object(I.a)(C.a)(p||(p=Object(P.a)([""]))),ce=Object(I.a)(C.a)(h||(h=Object(P.a)(["\n  border: 1px solid black;\n"]))),ae=Object(I.a)(C.a)(x||(x=Object(P.a)(["\n  border: 1px solid black;\n"]))),re=Object(I.a)(C.a)(v||(v=Object(P.a)(["\n  background-color: ",";\n  color: ",";\n  border: 1px solid black;\n"])),(function(e){return e.color}),(function(e){return e.textcolor})),oe=Object(I.a)(C.a)(O||(O=Object(P.a)(["\n  border: 1px solid black;\n"]))),le=I.a.a(g||(g=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n  text-decoration: none;\n\n  &:hover {\n    background-color: rgba(116, 238, 63, 0.5);\n    font-weight: 500;\n  }\n"]))),se=t(301),de=t(311),be=t(303),je=t(266),ue=t(302),pe=Object(se.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:"#E3DFDF",border:"3px solid #66FA00",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),maxHeight:"70%",overflow:"scroll"}}}));function he(e){var n=e.buttonName,t=e.references,i=pe(),c=f.a.useState(!1),a=Object(w.a)(c,2),r=a[0],o=a[1];return Object(z.jsxs)("div",{children:[Object(z.jsx)(ue.a,{color:"secondary",onClick:function(){o(!0)},variant:"outlined",children:n}),Object(z.jsx)(de.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:r,onClose:function(){o(!1)},closeAfterTransition:!0,BackdropComponent:be.a,BackdropProps:{timeout:500},children:Object(z.jsx)(je.a,{in:r,children:Object(z.jsx)("div",{className:i.paper,children:t.map((function(e,n){return Object(z.jsx)("p",{children:Object(z.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",children:[e," "]},n+e)})}))})})})]})}var xe,ve,Oe,ge,me,fe,ke=function(e){var n=e.cve,t=e.references,i=e.cvss,c=e.summary,a="",r="black";return i>0&&i<4&&(a="green",r="white"),i>3.9&&i<7&&(a="yellow"),i>6.9&&i<9&&(a="red",r="white"),i>8.9&&i<11&&(a="#34495E",r="white"),Object(z.jsx)(te,{children:Object(z.jsxs)(ie,{container:!0,justifyContent:"center",alignItems:"center",children:[Object(z.jsx)(ce,{item:!0,xs:3,children:Object(z.jsx)(le,{href:"https://nvd.nist.gov/vuln/detail/"+n,target:"_blank",children:n})}),Object(z.jsx)(ae,{item:!0,xs:3,children:Object(z.jsx)(he,{buttonName:"Solution Links",references:t})}),Object(z.jsx)(re,{item:!0,xs:3,color:a,textcolor:r,children:i}),Object(z.jsx)(oe,{item:!0,xs:12,children:c})]})})},ye=Object(I.a)(T.a)(xe||(xe=Object(P.a)(["\n  background-color: #17202a;\n  background-image: -webkit-linear-gradient(30deg, #34495e 50%, #212f3d 50%);\n  color: white;\n  border: 2px solid white;\n  padding: 0.5em;\n"]))),we=Object(I.a)(C.a)(ve||(ve=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n"]))),Ce=Object(I.a)(C.a)(Oe||(Oe=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n"]))),Pe=I.a.h2(ge||(ge=Object(P.a)([""]))),Ie=I.a.strong(me||(me=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n"]))),Se=I.a.a(fe||(fe=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 0.2em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n  text-decoration: none;\n\n  &:hover {\n    background-color: rgba(116, 238, 63, 0.5);\n    font-weight: 500;\n  }\n"]))),Ee=Object(se.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:"rgba(189, 203, 217)",border:"2px solid red",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function Te(e){var n=e.buttonName,t=e.info,i=Ee(),c=f.a.useState(!1),a=Object(w.a)(c,2),r=a[0],o=a[1];return Object(z.jsxs)("div",{children:[Object(z.jsx)(ue.a,{color:"inherit",onClick:function(){o(!0)},variant:"outlined",display:"none",children:n}),Object(z.jsx)(de.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:r,onClose:function(){o(!1)},closeAfterTransition:!0,BackdropComponent:be.a,BackdropProps:{timeout:500},children:Object(z.jsx)(je.a,{in:r,children:Object(z.jsx)("div",{className:i.paper,children:Object(z.jsx)(L,{info:t,singleIp:!0})})})})]})}var Ve,ze,We,Fe,Ae,Ne,De,_e,Re,qe,Le,Ue,Be,He=function(e){var n=e.ip,t=e.numVulns,i=e.org,c=e.isp,a=e.data,r=e.lastUpdate,o=e.country,l=e.city,s=e.asn,d=e.tags,b=e.ports,j=e.hostnames,u=e.domains,p="";return p=t>0?"Se han detectado ".concat(t," vulnerabilidades"):"No se han detectado vulnerabilidades",Object(z.jsx)(ye,{children:Object(z.jsxs)(we,{container:!0,justifyContent:"center",alignItems:"center",spacing:3,children:[Object(z.jsx)(Ce,{item:!0,xs:3,children:Object(z.jsxs)(Pe,{children:["IP: ",n]})}),Object(z.jsx)(Ce,{item:!0,xs:3,children:p}),Object(z.jsxs)(Ce,{item:!0,xs:3,children:["ORG: ",i]}),Object(z.jsxs)(Ce,{item:!0,xs:3,children:["ISP: ",c]}),Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Last_Update: ",r]}),Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Location: ",o," - ",l]}),Object(z.jsxs)(Ce,{item:!0,xs:3,children:["ASN: ",s]}),d&&Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Tags:"," ",d.map((function(e,n){return Object(z.jsx)(Ie,{children:e},e+n)}))]}),b&&Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Ports:"," ",b.map((function(e,t){return Object(z.jsx)(Se,{href:"https://"+n+":"+e,target:"_blank",children:e},e+t)}))]}),j&&Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Hostnames:"," ",j.map((function(e,n){return Object(z.jsx)(Se,{href:"https://"+e,target:"_blank",children:e},e+n)}))]}),u&&Object(z.jsxs)(Ce,{item:!0,xs:3,children:["Domain: ",u.map((function(e){return e}))]}),t>0&&Object(z.jsx)(Ce,{item:!0,xs:3,children:Object(z.jsx)(Te,{info:a,buttonName:"RESUMEN CVSS +"})})]})})},Ge=function(e){var n=e.ip,t=e.data,i=e.org,c=e.isp,a=e.lastUpdate,r=e.country,o=e.city,l=e.asn,s=e.tags,d=e.ports,b=e.hostnames,j=e.domains;return Object(z.jsxs)($,{children:[Object(z.jsx)(ne,{children:Object(z.jsx)(He,{ip:n,numVulns:t.length,org:i,isp:c,data:t,lastUpdate:"".concat(null===a||void 0===a?void 0:a.substr(0,10)," ").concat(null===a||void 0===a?void 0:a.substr(11,8)),country:r,city:o,asn:l,tags:s,ports:d,hostnames:b,domains:j})}),t.map((function(e,t){return Object(z.jsx)(ee,{children:Object(z.jsx)(ke,{cve:e.cve,cvss:e.cvss,summary:e.summary,references:e.references})},"SHdata-".concat(n)+t)}))]})},Qe=function(e){var n=e.info;return Object(z.jsx)(Y,{children:n.map((function(e,n){return"undefined"!=typeof e.vuln.vulns?Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(Ge,{ip:e.vuln.ip_str,data:e.data,org:e.vuln.org,isp:e.vuln.isp,lastUpdate:e.vuln.last_update,country:e.vuln.country_name,city:e.vuln.city,asn:e.vuln.asn,tags:e.vuln.tags,ports:e.vuln.ports,hostnames:e.vuln.hostnames,domains:e.vuln.domains},"sh"-n-e.vuln.ip_str)}):Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(Ge,{ip:e.vuln.ip_str,data:[],org:e.vuln.org,isp:e.vuln.isp,lastUpdate:e.vuln.last_update,country:e.vuln.country_name,city:e.vuln.city,asn:e.vuln.asn,tags:e.vuln.tags,ports:e.vuln.ports,hostnames:e.vuln.hostnames,domains:e.vuln.domains},"shSV"-n-e.vuln.ip_str)})}))})},Je=t(124),Me=t.n(Je),Ye=I.a.div(Ve||(Ve=Object(P.a)(["\n  padding-top: 100px;\n  background-color: rgba(189, 203, 217);\n"]))),Ke=I.a.h2(ze||(ze=Object(P.a)(["\n  margin: 0;\n  padding: 0.5em;\n  background-color: black;\n  color: white;\n  text-align: center;\n"]))),Xe=I.a.p(We||(We=Object(P.a)(["\n  margin: 0;\n  padding: 0.5em;\n  background-color: black;\n  color: white;\n  text-align: right;\n  font-size: 1.8em;\n  font-weight: 500;\n"]))),Ze=I.a.hr(Fe||(Fe=Object(P.a)(["\n  border: 4px solid green;\n  margin: 0;\n"]))),$e=I.a.p(Ae||(Ae=Object(P.a)(["\n  color: black;\n  background-color: rgba(116, 238, 63, 0.5);\n  border-radius: 10px;\n  margin: 0;\n  padding: 0.5em;\n  text-align: left;\n  font-size: 1.2em;\n"]))),en=I.a.h3(Ne||(Ne=Object(P.a)(["\n  color: ",";\n  padding: 1em;\n"])),(function(e){var n;return null!==(n=e.color)&&void 0!==n?n:"white"})),nn=I.a.div(De||(De=Object(P.a)(["\n  background-color: ",";\n  height: 100%;\n"])),(function(e){return e.color})),tn=I.a.div(_e||(_e=Object(P.a)(["\n  background-color: black;\n  height: 100%;\n"]))),cn=Object(I.a)(C.a)(Re||(Re=Object(P.a)(["\n  padding: 2em;\n"]))),an=I.a.div(qe||(qe=Object(P.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding-top: 15em;\n  padding-bottom: 15em;\n"]))),rn=I.a.h2(Le||(Le=Object(P.a)(["\n  color: #7ed321;\n  font-size: 30px;\n"]))),on=t(305),ln=t(309),sn=t(308),dn=t(304),bn=t(306),jn=t(307),un=t(265),pn=t(123),hn=I.a.button(Ue||(Ue=Object(P.a)(["\n  color: white;\n  background-color: rgba(116, 238, 63, 0.3);\n  padding: 1em;\n  font-size: 0.9em;\n  display: inline-block;\n  text-align: center;\n  margin-right: 0.3em;\n  margin-bottom: 0.3em;\n  border-radius: 5px;\n  text-decoration: none;\n\n  &:hover {\n    background-color: rgba(116, 238, 63, 0.5);\n    font-weight: 500;\n  }\n"]))),xn=function(e){var n=e.csvData,t=e.fileName;return Object(z.jsx)(hn,{variant:"warning",children:Object(z.jsx)(pn.CSVLink,{data:n,filename:t,children:"Export"})})},vn=I.a.div(Be||(Be=Object(P.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])));var On,gn,mn,fn,kn,yn,wn,Cn,Pn,In,Sn,En=function(e){var n,t,i,c,a,r,o,l=e.info,s=l.map((function(e){return e.data.length})),d=R(s),b=N(null===(n=l)||void 0===n?void 0:n.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return 1*e.cvss}))}))),j=(q(R(b),d),function(e,n){var t,i=(new Date).getFullYear();e=null===(t=e)||void 0===t?void 0:t.map((function(e){return 365*(i-e)}));var c,a=1*(R(e)/n).toFixed(2);return a>=280?c=1:a>=140&&a<280?c=.5:a<140&&(c=.1),c}(N(l.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n;return 1*(null===e||void 0===e||null===(n=e.cve)||void 0===n?void 0:n.substr(4,4))}))}))),d));null===(t=l)||void 0===t||t.map((function(e){var n;return e.vuln.poe=(1*(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length)/d).toFixed(2)}));var u=l.map((function(e){var n;return null===e||void 0===e||null===(n=e.vuln)||void 0===n?void 0:n.ports})),p=A(N(u));null===(i=l)||void 0===i||i.map((function(e){var n,t,i,c;return e.vuln.popI=1*(null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.ports)||void 0===t?void 0:t.length)>=10?1:(1*(null===e||void 0===e||null===(i=e.vuln)||void 0===i||null===(c=i.ports)||void 0===c?void 0:c.length)/p.length).toFixed(2)})),null===(c=l)||void 0===c||c.map((function(e){var n,t;return e.vuln.pqt=1*(null===e||void 0===e||null===(n=e.vuln)||void 0===n||null===(t=n.tags)||void 0===t?void 0:t.length)>0?1:0})),null===(a=l)||void 0===a||a.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n,t;return e.tr=(null===e||void 0===e||null===(n=e.references)||void 0===n?void 0:n.length)>10?1:((null===e||void 0===e||null===(t=e.references)||void 0===t?void 0:t.length)/10).toFixed(2)}))})),null===(r=l)||void 0===r||r.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return e.ep=1*(null===e||void 0===e?void 0:e.cvss)>=7?1:1*(null===e||void 0===e?void 0:e.cvss)>=4&&1*(null===e||void 0===e?void 0:e.cvss)<7?.5:.1}))})),l=function(e,n){console.log(e);for(var t=0;t<(null===e||void 0===e?void 0:e.length);t++){e[t].vuln.poe=1*e[t].vuln.poe,e[t].vuln.popI=1*e[t].vuln.popI,e[t].vuln.pqt=1*e[t].vuln.pqt;for(var i=0;i<(null===(c=e[t])||void 0===c||null===(a=c.data)||void 0===a?void 0:a.length);i++){var c,a;e[t].data[i].poe=1*e[t].vuln.poe,e[t].data[i].popI=1*e[t].vuln.popI,e[t].data[i].pqt=1*e[t].vuln.pqt,e[t].data[i].cvss=1*e[t].data[i].cvss,e[t].data[i].tr=1*e[t].data[i].tr,e[t].data[i].po=1*((e[t].data[i].tr+e[t].data[i].ep)/2*((e[t].vuln.poe+e[t].vuln.popI+e[t].vuln.pqt)/3)*n).toFixed(2),e[t].data[i].impact=e[t].data[i].cvss/10,e[t].data[i].rf=1*(e[t].data[i].po*e[t].data[i].impact).toFixed(2),e[t].data[i].ip=e[t].vuln.ip_str}}return e}(l,j);var h,x,v,O=(h=N(null===(o=l)||void 0===o?void 0:o.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return e}))}))),x="rf",v="desc",h.sort((function(e,n){var t=e[x],i=n[x];return"asc"===v?t<i?-1:t>i?1:0:"desc"===v?t>i?-1:t<i?1:0:void 0})));console.log(l);var g=[];return null===O||void 0===O||O.map((function(e,n){var t=e.ip,i=e.cve,c=e.cvss,a=e.tr,r=e.ep,o=e.poe,l=e.popI,s=e.pqt,d=e.rf;return g.push(function(e,n,t,i,c,a,r,o,l,s){return{id:e,ip:n,cve:t,cvss:i,tr:c,ep:a,poe:r,popI:o,pqt:l,risk:s}}("ESP-vuln-"+(n+1)+"-"+i,t,i,c,a,r,o,l,s,d))})),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(vn,{children:Object(z.jsx)(xn,{csvData:O,fileName:"test"})}),Object(z.jsx)(un.a,{sx:{width:"100%",overflow:"hidden"},children:Object(z.jsx)(dn.a,{sx:{maxHeight:"440px"},children:Object(z.jsxs)(on.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(z.jsx)(bn.a,{children:Object(z.jsxs)(jn.a,{children:[Object(z.jsx)(sn.a,{align:"center",style:{minWidth:100},children:"ID"},"id"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"IP"},"ip"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"CVE"},"cve"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"CVSS"},"cvss"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"TR"},"tr"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"EP"},"ep"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"POE"},"poe"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"POP"},"popI"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"PQT"},"pqt"),Object(z.jsx)(sn.a,{align:"center",style:{minWidth:90},children:"RISK FACTOR"},"rf")]})}),Object(z.jsx)(ln.a,{children:g.map((function(e,n){var t=e.ip,i=e.cve,c=e.cvss,a=e.tr,r=e.ep,o=e.poe,l=e.popI,s=e.pqt,d=e.risk,b=(e.name,e.id);return Object(z.jsxs)(jn.a,{children:[Object(z.jsx)(sn.a,{component:"th",scope:"row",align:"center",children:b}),Object(z.jsx)(sn.a,{align:"center",children:t}),Object(z.jsx)(sn.a,{align:"center",children:i}),Object(z.jsx)(sn.a,{align:"center",children:c}),Object(z.jsx)(sn.a,{align:"center",children:a}),Object(z.jsx)(sn.a,{align:"center",children:r}),Object(z.jsx)(sn.a,{align:"center",children:o}),Object(z.jsx)(sn.a,{align:"center",children:l}),Object(z.jsx)(sn.a,{align:"center",children:s}),Object(z.jsx)(sn.a,{align:"center",children:d})]},n+i)}))})]})})})]})},Tn=function(){var e,n=Object(m.useState)(["192.188.58.61","192.188.58.50","192.188.58.45","192.188.58.59","192.188.58.63","192.188.58.78","192.188.58.180","192.188.58.75"]),t=Object(w.a)(n,1)[0],i=function(e){for(var n=[],t=0;t<(null===e||void 0===e?void 0:e.length);t++){var i,c;(null===(i=e[t])||void 0===i||null===(c=i.data)||void 0===c?void 0:c.length)>1&&n.push(e[t])}return n}(t.map((function(e){return function(e){var n=Object(m.useState)([]),t=Object(w.a)(n,2),i=t[0],c=t[1],a=Object(m.useState)([]),r=Object(w.a)(a,2),o=r[0],l=r[1];return Object(m.useEffect)((function(){fetch("https://api.shodan.io/shodan/host/"+e+"?key=FL5f6aSOu464esmyqf7c0kDDi0UycPNN").then((function(e){return e.json()})).then((function(e){if("undefined"!=typeof e.vulns){c(e);var n=function(e,n){for(var t=[],i=[],c=0,a=0;a<e.length;a++)"undefined"!=typeof e[a].vulns&&t.push(e[a].vulns);for(var r=0;r<n.length;r++){c=0;for(var o=0;o<t.length;o++)"undefined"!=typeof t[o][n[r]]&&n[r].index===t[o][n[r]].index&&c<1&&(t[o][n[r]].cve=n[r],i.push(t[o][n[r]]),c++)}return i}(e.data,e.vulns);l(n)}}),(function(e){console.log(e)}))}),[e]),{vuln:i,data:o}}(e)}))),c=null===i||void 0===i?void 0:i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length})),a=R(c),r=N(null===i||void 0===i?void 0:i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){return 1*e.cvss}))}))),o=q(R(r),a),l=N(i.map((function(e){var n;return null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.map((function(e){var n;return 1*(null===e||void 0===e||null===(n=e.cve)||void 0===n?void 0:n.substr(4,4))}))}))),s=(new Date).getFullYear();l=null===(e=l)||void 0===e?void 0:e.map((function(e){return 365*(s-e)}));var d=1*(R(l)/a).toFixed(2),b=o>0&&o<=3.9?"rgba(116, 238, 63)":o>3.9&&o<=6.9?"rgba(234, 231, 46)":o>6.9&&o<=8.9?"rgba(237, 45, 19)":"rgba(63, 62, 62)",j=Object(m.useState)(!1),u=Object(w.a)(j,2),p=u[0],h=u[1];return Object(m.useEffect)((function(){h(!0),setTimeout((function(){h(!1)}),1e4)}),[]),Object(z.jsx)(z.Fragment,{children:p?Object(z.jsxs)(an,{children:[Object(z.jsx)(Me.a,{size:100,color:"#7ED321",loading:p}),Object(z.jsx)(rn,{children:"CARGANDO....."})]}):Object(z.jsxs)(Ye,{id:"top",children:[Object(z.jsx)(Ze,{}),Object(z.jsxs)("section",{id:"gi",children:[Object(z.jsx)(Ke,{children:"Informacion General de la Organizacion"}),Object(z.jsxs)(cn,{container:!0,justifyContent:"center",spacing:3,children:[Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(tn,{children:[Object(z.jsx)(en,{children:"Organizacion"}),Object(z.jsx)(Xe,{children:"Escuela Politecnica del Ejercito"}),Object(z.jsx)(Ze,{})]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(tn,{children:[Object(z.jsx)(en,{children:"Total de vulnerabilidades identificadas"}),Object(z.jsx)(Xe,{children:a}),Object(z.jsx)(Ze,{})]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(tn,{children:[Object(z.jsx)(en,{children:"Total de IP escaneadas"}),Object(z.jsx)(Xe,{children:null===t||void 0===t?void 0:t.length}),Object(z.jsx)(Ze,{})]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(tn,{children:[Object(z.jsx)(en,{children:"Total de IP con Vulnerabilidades"}),Object(z.jsx)(Xe,{children:null===i||void 0===i?void 0:i.length}),Object(z.jsx)(Ze,{})]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(nn,{color:b,children:[Object(z.jsx)(en,{color:"rgba(63, 62, 62)"===b?"white":"black",children:"Riesgo Promedio de la Organizacion (AOR)"}),Object(z.jsx)(Xe,{children:o}),Object(z.jsx)(Ze,{})]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)(tn,{children:[Object(z.jsx)(en,{children:"Tiempo Promedio de Vulnerabilidades (AVT)"}),Object(z.jsxs)(Xe,{children:[d," dias"]}),Object(z.jsx)(Ze,{})]})})]})]}),Object(z.jsxs)("section",{id:"vi",children:[Object(z.jsx)(Ze,{}),Object(z.jsx)(Ke,{children:"Informacion General de Vulnerabilidades"}),Object(z.jsx)(M,{info:i})]}),Object(z.jsxs)("section",{id:"db",children:[Object(z.jsx)(Ze,{}),Object(z.jsx)(Ke,{children:"IP Banner y Vulnerabilidades Detalladas"}),Object(z.jsx)(Qe,{info:i})]}),Object(z.jsxs)("section",{id:"pt",children:[Object(z.jsx)(Ze,{}),Object(z.jsx)(Ke,{children:"Priorizacion de Vulnerabilidades"}),Object(z.jsx)(Ze,{}),Object(z.jsx)(Ke,{children:"Descripcion Variables de Entorno"}),Object(z.jsxs)(cn,{container:!0,justifyContent:"center",spacing:3,children:[Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"CVE: "})," Common Vulnerabilities and Exposures"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"CVSS: "})," Common Vulnerability Scoring System"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"TR: "})," Total References"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"EP: "})," Exploitation Probability"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"POE: "})," Probability of Occurrence of an Event in the IP"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"POP: "})," Probability of Open Ports"]})}),Object(z.jsx)(C.a,{item:!0,md:4,children:Object(z.jsxs)($e,{children:[Object(z.jsx)("strong",{children:"PQT: "})," Probability for Query Tags"]})})]}),Object(z.jsx)(Ze,{}),Object(z.jsx)(Ke,{children:"Tabla de Priorizacion"}),Object(z.jsx)(Ze,{}),Object(z.jsx)(En,{info:i})]})]})})},Vn=t(310),zn=t(88),Wn=Object(I.a)(Vn.a)(On||(On=Object(P.a)(["\n  padding-top: 1em;\n  padding-bottom: 1em;\n  background-color: white !important;\n"]))),Fn=Object(I.a)(T.a)(gn||(gn=Object(P.a)(["\n  padding: 0.5em;\n"]))),An=I.a.nav(mn||(mn=Object(P.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n"]))),Nn=Object(I.a)(zn.Link)(fn||(fn=Object(P.a)(["\n  color: black !important;\n  text-transform: uppercase;\n  font-size: 1em;\n  text-align: center;\n\n  &:hover {\n    border-bottom: 3px solid green;\n  }\n"]))),Dn=Object(I.a)(zn.Link)(kn||(kn=Object(P.a)([""]))),_n=I.a.img(yn||(yn=Object(P.a)(["\n  width: 200px;\n  height: 55px;\n"]))),Rn=function(){return Object(z.jsx)(Wn,{children:Object(z.jsx)(Fn,{children:Object(z.jsxs)(An,{children:[Object(z.jsx)(Dn,{to:"top",spy:!0,smooth:!0,children:Object(z.jsx)(_n,{src:"https://www.espe.edu.ec/wp-content/uploads/2018/11/espe.png",alt:"logo"})}),Object(z.jsx)(Nn,{to:"gi",spy:!0,smooth:!0,children:"Informacion General"}),Object(z.jsx)(Nn,{to:"vi",spy:!0,smooth:!0,children:"Informacion de Vulnerabilidades"}),Object(z.jsx)(Nn,{to:"db",spy:!0,smooth:!0,children:"Banner Detallados"}),Object(z.jsx)(Nn,{to:"pt",spy:!0,smooth:!0,children:"Tabla de Priorizacion"})]})})})},qn=I.a.footer(wn||(wn=Object(P.a)(["\n  border-top: 5px solid green;\n"]))),Ln=Object(I.a)(T.a)(Cn||(Cn=Object(P.a)([""]))),Un=I.a.div(Pn||(Pn=Object(P.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]))),Bn=I.a.img(In||(In=Object(P.a)(["\n  width: 200px;\n  height: 55px;\n"]))),Hn=I.a.p(Sn||(Sn=Object(P.a)(["\n  max-width: 300px;\n"]))),Gn=function(){return Object(z.jsx)(qn,{children:Object(z.jsx)(Ln,{children:Object(z.jsxs)(Un,{children:[Object(z.jsx)(Bn,{src:"https://www.espe.edu.ec/wp-content/uploads/2018/11/espe.png",alt:"logo"}),Object(z.jsxs)(Hn,{children:[Object(z.jsx)("strong",{children:"PROJECT NAME."})," ",Object(z.jsx)("br",{}),"Design and Implementation of the IT infrastructure and service management system for the ESPE Academic CERT"]}),Object(z.jsxs)(Hn,{children:[Object(z.jsx)("strong",{children:"\xa9 2021 PIC-2020-ESPE-CERT."})," ",Object(z.jsx)("br",{}),"Todos los derechos reservados."]})]})})})};var Qn=function(){return Object(z.jsxs)("div",{children:[Object(z.jsx)(Rn,{}),Object(z.jsx)(Tn,{}),Object(z.jsx)(Gn,{})]})};y.a.render(Object(z.jsx)(Qn,{}),document.getElementById("root"))}},[[263,1,2]]]);
//# sourceMappingURL=main.2767eb5a.chunk.js.map